<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>RegentAI ‚Äî Your Campus Assistant</title>
  <link rel="stylesheet" href="./css/main.css">
  <link rel="stylesheet" href="./css/themes.css">
  <style>
    :root{
      --ai-bg:#0a0e1a;
      --ai-panel:#111827;
      --ai-card:#1f2937;
      --ai-text:#f9fafb;
      --ai-muted:#9ca3af;
      --ai-accent:#667eea;
      --ai-accent-dark:#764ba2;
      --ai-border:rgba(255,255,255,0.06);
    }

    *{box-sizing:border-box;margin:0;padding:0}
    html,body{
      height:100%;
      font-family:'Segoe UI',Roboto,'Helvetica Neue',Arial,sans-serif;
      background:var(--ai-bg);
      color:var(--ai-text);
      overflow:hidden;
    }

    /* Header */
    .ai-header{
      background:var(--ai-panel);
      padding:16px 24px;
      border-bottom:1px solid var(--ai-border);
      display:flex;
      align-items:center;
      justify-content:space-between;
    }

    .ai-logo{
      display:flex;
      align-items:center;
      gap:12px;
      font-size:20px;
      font-weight:600;
    }

    .ai-logo-icon{
      width:40px;
      height:40px;
      border-radius:10px;
      background:linear-gradient(135deg,var(--ai-accent),var(--ai-accent-dark));
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:24px;
    }

    .ai-actions{
      display:flex;
      gap:12px;
    }

    .btn{
      padding:10px 20px;
      border-radius:8px;
      border:none;
      cursor:pointer;
      font-size:14px;
      font-weight:600;
      transition:all 0.2s;
      text-decoration:none;
      display:inline-block;
    }

    .btn.primary{
      background:linear-gradient(135deg,var(--ai-accent),var(--ai-accent-dark));
      color:white;
    }

    .btn.primary:hover{
      transform:translateY(-2px);
      box-shadow:0 8px 16px rgba(102,126,234,0.3);
    }

    .btn.secondary{
      background:transparent;
      border:1px solid var(--ai-border);
      color:var(--ai-text);
    }

    .btn.secondary:hover{
      background:rgba(255,255,255,0.05);
    }

    /* Main Container */
    .ai-container{
      height:calc(100vh - 73px);
      max-width:900px;
      margin:0 auto;
      display:flex;
      flex-direction:column;
      padding:0;
    }

    /* Welcome Screen */
    .welcome-screen{
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      flex:1;
      text-align:center;
      padding:40px 20px;
    }

    .welcome-icon{
      font-size:80px;
      margin-bottom:24px;
      animation:float 3s ease-in-out infinite;
    }

    @keyframes float{
      0%,100%{transform:translateY(0px)}
      50%{transform:translateY(-10px)}
    }

    .welcome-title{
      font-size:32px;
      font-weight:700;
      margin-bottom:12px;
      background:linear-gradient(135deg,var(--ai-accent),var(--ai-accent-dark));
      -webkit-background-clip:text;
      -webkit-text-fill-color:transparent;
      background-clip:text;
    }

    .welcome-subtitle{
      font-size:18px;
      color:var(--ai-muted);
      margin-bottom:32px;
    }

    .suggestion-cards{
      display:grid;
      grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
      gap:16px;
      width:100%;
      max-width:700px;
      margin-top:32px;
    }

    .suggestion-card{
      background:var(--ai-card);
      padding:20px;
      border-radius:12px;
      border:1px solid var(--ai-border);
      cursor:pointer;
      transition:all 0.2s;
    }

    .suggestion-card:hover{
      background:var(--ai-panel);
      transform:translateY(-2px);
      box-shadow:0 8px 24px rgba(0,0,0,0.3);
    }

    .suggestion-icon{
      font-size:32px;
      margin-bottom:12px;
    }

    .suggestion-title{
      font-size:16px;
      font-weight:600;
      margin-bottom:8px;
    }

    .suggestion-text{
      font-size:13px;
      color:var(--ai-muted);
    }

    /* Chat Container */
    .chat-container{
      display:flex;
      flex-direction:column;
      height:100%;
    }

    .messages-container{
      flex:1;
      overflow-y:auto;
      padding:24px;
      display:flex;
      flex-direction:column;
      gap:16px;
    }

    .messages-container::-webkit-scrollbar{
      width:6px;
    }

    .messages-container::-webkit-scrollbar-thumb{
      background:rgba(255,255,255,0.1);
      border-radius:3px;
    }

    .message{
      display:flex;
      gap:12px;
      animation:messageSlideIn 0.3s ease;
    }

    @keyframes messageSlideIn{
      from{opacity:0;transform:translateY(10px)}
      to{opacity:1;transform:translateY(0)}
    }

    .message.user{
      justify-content:flex-end;
    }

    .message-avatar{
      width:36px;
      height:36px;
      border-radius:50%;
      background:linear-gradient(135deg,var(--ai-accent),var(--ai-accent-dark));
      display:flex;
      align-items:center;
      justify-content:center;
      font-size:20px;
      flex-shrink:0;
    }

    .message-bubble{
      max-width:70%;
      padding:12px 16px;
      border-radius:16px;
      line-height:1.5;
    }

    .message.ai .message-bubble{
      background:var(--ai-card);
      border:1px solid var(--ai-border);
      border-top-left-radius:4px;
    }

    .message.user .message-bubble{
      background:linear-gradient(135deg,var(--ai-accent),var(--ai-accent-dark));
      color:white;
      border-top-right-radius:4px;
    }

    .message-time{
      font-size:11px;
      color:var(--ai-muted);
      margin-top:4px;
      text-align:right;
    }

    .typing-indicator{
      display:flex;
      gap:4px;
      padding:12px 16px;
      background:var(--ai-card);
      border:1px solid var(--ai-border);
      border-radius:16px;
      width:fit-content;
    }

    .typing-dot{
      width:8px;
      height:8px;
      border-radius:50%;
      background:var(--ai-muted);
      animation:typingBounce 1.4s infinite;
    }

    .typing-dot:nth-child(2){animation-delay:0.2s}
    .typing-dot:nth-child(3){animation-delay:0.4s}

    @keyframes typingBounce{
      0%,60%,100%{transform:translateY(0)}
      30%{transform:translateY(-8px)}
    }

    /* Input Area */
    .input-container{
      padding:20px 24px;
      background:var(--ai-panel);
      border-top:1px solid var(--ai-border);
    }

    .input-wrapper{
      display:flex;
      gap:12px;
      align-items:flex-end;
      max-width:900px;
      margin:0 auto;
    }

    .input-field{
      flex:1;
      background:var(--ai-card);
      border:1px solid var(--ai-border);
      border-radius:12px;
      padding:12px 16px;
      color:var(--ai-text);
      font-size:15px;
      font-family:inherit;
      resize:none;
      max-height:120px;
      min-height:48px;
    }

    .input-field:focus{
      outline:none;
      border-color:var(--ai-accent);
      box-shadow:0 0 0 3px rgba(102,126,234,0.1);
    }

    .send-btn{
      width:48px;
      height:48px;
      border-radius:12px;
      background:linear-gradient(135deg,var(--ai-accent),var(--ai-accent-dark));
      border:none;
      color:white;
      font-size:20px;
      cursor:pointer;
      transition:all 0.2s;
      display:flex;
      align-items:center;
      justify-content:center;
    }

    .send-btn:hover{
      transform:translateY(-2px);
      box-shadow:0 8px 16px rgba(102,126,234,0.3);
    }

    .send-btn:disabled{
      opacity:0.5;
      cursor:not-allowed;
      transform:none;
    }

    /* Responsive */
    @media(max-width:768px){
      .ai-header{padding:12px 16px}
      .ai-container{padding:0}
      .messages-container{padding:16px}
      .input-container{padding:16px}
      .suggestion-cards{grid-template-columns:1fr}
      .welcome-title{font-size:24px}
    }
  </style>
</head>
<body>
  <!-- Header -->
  <div class="ai-header">
    <div class="ai-logo">
      <div class="ai-logo-icon">ü§ñ</div>
      <span>RegentAI</span>
    </div>
    <div class="ai-actions">
      <a href="index.html" class="btn secondary">‚Üê Home</a>
      <a href="login.html" class="btn primary">Sign In to Continue</a>
    </div>
  </div>

  <!-- Main Container -->
  <div class="ai-container">
    <!-- Welcome Screen -->
    <div class="welcome-screen" id="welcomeScreen">
      <div class="welcome-icon">ü§ñ</div>
      <h1 class="welcome-title">Hello! I'm RegentAI</h1>
      <p class="welcome-subtitle">Your intelligent campus assistant</p>
      <p style="color:var(--ai-muted);max-width:600px">
        Ask me anything about campus life, study tips, project ideas, career advice, or just chat!
      </p>

      <div class="suggestion-cards">
        <div class="suggestion-card" onclick="askQuestion('Tell me about campus clubs and organizations')">
          <div class="suggestion-icon">üéì</div>
          <div class="suggestion-title">Campus Info</div>
          <div class="suggestion-text">Clubs, events, and activities</div>
        </div>

        <div class="suggestion-card" onclick="askQuestion('Give me study tips for exams')">
          <div class="suggestion-icon">üìö</div>
          <div class="suggestion-title">Study Help</div>
          <div class="suggestion-text">Tips and strategies</div>
        </div>

        <div class="suggestion-card" onclick="askQuestion('Suggest some project ideas for CS students')">
          <div class="suggestion-icon">üí°</div>
          <div class="suggestion-title">Project Ideas</div>
          <div class="suggestion-text">Tech and innovation</div>
        </div>

        <div class="suggestion-card" onclick="askQuestion('How can I prepare for a tech career?')">
          <div class="suggestion-icon">üíº</div>
          <div class="suggestion-title">Career Advice</div>
          <div class="suggestion-text">Jobs and internships</div>
        </div>
      </div>
    </div>

    <!-- Chat Container (initially hidden) -->
    <div class="chat-container" id="chatContainer" style="display:none">
      <div class="messages-container" id="messagesContainer"></div>

      <div class="input-container">
        <div class="input-wrapper">
          <textarea 
            class="input-field" 
            id="messageInput" 
            placeholder="Ask me anything..."
            rows="1"
          ></textarea>
          <button class="send-btn" id="sendBtn" onclick="sendMessage()">
            <span>‚û§</span>
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Load AI module -->
  <script src="./js/db.js"></script>
  <script src="./js/ai.js"></script>

  <script>
    const welcomeScreen = document.getElementById('welcomeScreen');
    const chatContainer = document.getElementById('chatContainer');
    const messagesContainer = document.getElementById('messagesContainer');
    const messageInput = document.getElementById('messageInput');
    const sendBtn = document.getElementById('sendBtn');

    let chatStarted = false;

    // Auto-resize textarea
    messageInput.addEventListener('input', function() {
      this.style.height = 'auto';
      this.style.height = (this.scrollHeight) + 'px';
    });

    // Send on Enter (Shift+Enter for new line)
    messageInput.addEventListener('keydown', function(e) {
      if (e.key === 'Enter' && !e.shiftKey) {
        e.preventDefault();
        sendMessage();
      }
    });

    function startChat() {
      if (!chatStarted) {
        welcomeScreen.style.display = 'none';
        chatContainer.style.display = 'flex';
        chatStarted = true;
        messageInput.focus();
      }
    }

    function askQuestion(question) {
      startChat();
      messageInput.value = question;
      setTimeout(() => sendMessage(), 300);
    }

    async function sendMessage() {
      const text = messageInput.value.trim();
      if (!text) return;

      startChat();

      // Add user message
      addMessage(text, 'user');
      messageInput.value = '';
      messageInput.style.height = 'auto';

      // Show typing indicator
      const typingId = showTyping();

      // Disable input
      messageInput.disabled = true;
      sendBtn.disabled = true;

      try {
        // Get AI response
        const response = await RegentAI.chat(text);
        
        // Remove typing indicator
        removeTyping(typingId);

        // Add AI response
        if (response.ok) {
          addMessage(response.response, 'ai');
        } else {
          addMessage('Sorry, I encountered an error. Please try again.', 'ai');
        }
      } catch (error) {
        removeTyping(typingId);
        addMessage('Sorry, I encountered an error. Please try again.', 'ai');
      }

      // Re-enable input
      messageInput.disabled = false;
      sendBtn.disabled = false;
      messageInput.focus();
    }

    function addMessage(text, type) {
      const messageDiv = document.createElement('div');
      messageDiv.className = `message ${type}`;

      if (type === 'ai') {
        messageDiv.innerHTML = `
          <div class="message-avatar">ü§ñ</div>
          <div>
            <div class="message-bubble">${escapeHtml(text)}</div>
            <div class="message-time">${formatTime()}</div>
          </div>
        `;
      } else {
        messageDiv.innerHTML = `
          <div>
            <div class="message-bubble">${escapeHtml(text)}</div>
            <div class="message-time">${formatTime()}</div>
          </div>
        `;
      }

      messagesContainer.appendChild(messageDiv);
      messagesContainer.scrollTop = messagesContainer.scrollHeight;
    }

    function showTyping() {
      const typingDiv = document.createElement('div');
      typingDiv.className = 'message ai';
      typingDiv.id = 'typing-' + Date.now();
      typingDiv.innerHTML = `
        <div class="message-avatar">ü§ñ</div>
        <div class="typing-indicator">
          <div class="typing-dot"></div>
          <div class="typing-dot"></div>
          <div class="typing-dot"></div>
        </div>
      `;
      messagesContainer.appendChild(typingDiv);
      messagesContainer.scrollTop = messagesContainer.scrollHeight;
      return typingDiv.id;
    }

    function removeTyping(id) {
      const typingDiv = document.getElementById(id);
      if (typingDiv) typingDiv.remove();
    }

    function formatTime() {
      return new Date().toLocaleTimeString('en-US', {
        hour: 'numeric',
        minute: '2-digit',
        hour12: true
      });
    }

    function escapeHtml(text) {
      const div = document.createElement('div');
      div.textContent = text;
      return div.innerHTML;
    }

    // Focus input when chat starts
    chatContainer.addEventListener('click', () => {
      if (chatStarted) messageInput.focus();
    });

    // Show welcome message for first-time visitors
    if (!localStorage.getItem('ai_visited')) {
      localStorage.setItem('ai_visited', 'true');
      
      setTimeout(() => {
        const welcomeMsg = document.createElement('div');
        welcomeMsg.style.cssText = `
          position: fixed;
          top: 80px;
          left: 50%;
          transform: translateX(-50%);
          background: linear-gradient(135deg, #667eea, #764ba2);
          color: white;
          padding: 16px 32px;
          border-radius: 12px;
          box-shadow: 0 8px 24px rgba(0,0,0,0.3);
          z-index: 10000;
          animation: slideDown 0.3s ease-out;
          text-align: center;
          max-width: 90%;
        `;
        welcomeMsg.innerHTML = `
          <strong>üëã Welcome to RegentAI!</strong><br>
          <span style="font-size:14px">Try me out! No login required.</span>
        `;
        
        document.body.appendChild(welcomeMsg);
        
        setTimeout(() => {
          welcomeMsg.style.animation = 'slideDown 0.3s ease-out reverse';
          setTimeout(() => welcomeMsg.remove(), 300);
        }, 4000);
      }, 1000);
    }

    const style = document.createElement('style');
    style.textContent = `
      @keyframes slideDown {
        from {
          opacity: 0;
          transform: translateX(-50%) translateY(-20px);
        }
        to {
          opacity: 1;
          transform: translateX(-50%) translateY(0);
        }
      }
    `;
    document.head.appendChild(style);

    console.log('ü§ñ RegentAI Public Interface Ready - No login required!');
  </script>
</body>
</html>
